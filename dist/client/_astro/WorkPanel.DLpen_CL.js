import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.DxhH1ShK.js";import{C as te}from"./Tabs.kO88Y3Ee.js";import{F as se}from"./FilterableList.BdbOYZr1.js";import{C as ae}from"./Link.BGo-y1Vn.js";import{g as E}from"./icon.Df9DBUhx.js";import{T as W,g as re}from"./utils.6p6Hyl_a.js";import{B as L}from"./Badge.CwoN8wRJ.js";import{P as ne}from"./PanelFooter.2n65IKfH.js";import{F as z}from"./PanelStat.C-DhdUjD.js";import{A as ie}from"./AuthStar.nxAGzTTY.js";import{T as le}from"./timeago-react.CCkgRyVe.js";import{P as oe}from"./PanelAction.a_cGOObt.js";import{S as X}from"./index.D4qZ0oW6.js";import{R as ce,T as de,a as me,b as he}from"./index.DPkKMAGE.js";import{N as _,a as xe}from"./NumberFlow-client-48rw3j0J.DO-Ted3l.js";import{B as ue}from"./Button.BK-c6KtM.js";import{c as fe}from"./utils.BnlJtBIq.js";import{C as F}from"./Tooltip.CRI7KqtE.js";import{P as ge,a as pe,b as be,c as ye,d as je,e as ve}from"./PopoverArrow.BaWnEbH-.js";import{P as Ne}from"./PopoverTitle.CfIfYysC.js";import{P as Ie}from"./PopoverDescription.C4Eu5Fxu.js";import{a as Z,g as we}from"./auth.C6MmFFld.js";import{e as Se,a as Te,d as ke}from"./issue.Cu6yhr5C.js";import{g as q,a as ee}from"./star.J0JRTi5O.js";import{c as Ee}from"./createLucideIcon.C1tpinp8.js";import{B as J}from"./Panel.BFyw-rTz.js";import{I as U,a as r,b as R,i as Ce,c as Pe}from"./issue.CJErfNqu.js";import{u as Ue}from"./useDrag.C9I1mCaR.js";import{e as Ae}from"./roadmap.Cq_m8jGZ.js";import{a as Q}from"./patch.CbMO86LR.js";import{C as Y}from"./DropTarget.Dj7XGDX6.js";import{D,H as B}from"./index.CeIpCxKj.js";import{a as _e}from"./virtual.VUcB3V37.js";import"./index.CG_O7YBG.js";import"./proxy.D4YeN7SK.js";import"./slot.RkfkL2mj.js";import"./SearchBar.B8HCoSqH.js";import"./List.CgTKD_hI.js";import"./ElectricBorder.DAWLx7iV.js";import"./index.DpQ8kv17.js";import"./index.C2SuE_cr.js";import"./index.CqUFkXl9.js";import"./index.Du2_2VfY.js";import"./index.DXWCtkbr.js";import"./index.DPjcTRdc.js";import"./ripple.8VKTSqqU.js";import"./roadmap.DwIP75iC.js";import"./client.B9YBqyHK.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Be=Ee("eye",De),Le=(t,a)=>t==null?a:a==null?t:Math.max(t,a),K=new WeakMap,Fe={onUpdate(t,a,x){if(K.set(x,void 0),!x.computedTrend)return;const p=a.integer.concat(a.fraction).filter(c=>c.type==="integer"||c.type==="fraction"),b=t.integer.concat(t.fraction).filter(c=>c.type==="integer"||c.type==="fraction"),o=p.find(c=>!b.find(g=>g.pos===c.pos&&g.value===c.value)),i=b.find(c=>!p.find(g=>c.pos===g.pos&&c.value===g.value));K.set(x,Le(o?.pos,i?.pos))},getDelta(t,a,x){const p=t-a,b=K.get(x.flow);if(!p&&b!=null&&b>=x.pos)return x.length*x.flow.computedTrend}},Ge=({availableSunshines:t,currentSunshines:a,issueId:x,galaxyId:p,userId:b,onApply:o})=>{const[i,c]=n.useState(a),[g,j]=n.useState(!1),[w]=n.useState(a);n.useEffect(()=>{c(a)},[a]);const l=s=>{c(s[0])},v=()=>{j(!0),o(i),setTimeout(()=>{j(!1)},2e3)},u=i-w;let f=t-u;f>t&&(f=t),f<0&&(f=0);const I=i!==w,P=a+t,S=Math.floor(i/360),H=Math.floor(a/360),d=e.jsx(F,{content:e.jsxs("div",{className:"text-sm space-y-3",children:[e.jsxs("div",{className:"font-semibold",children:["Total sunshines: ",a]}),e.jsxs("div",{className:"flex items-center gap-3 pt-2 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"text-4xl",children:E({iconType:"star",className:"w-10 h-10 text-yellow-400 dark:text-yellow-500",fill:"currentColor"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:H}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Potential Stars"}),e.jsxs("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:["(",a," ÷ 360)"]})]})]})]}),openDelay:500,children:e.jsxs("div",{className:"flex items-center space-x-1 justify-center cursor-pointer hover:opacity-80 transition-opacity",children:[E({iconType:"sunshine",fill:"currentColor",className:"w-5 h-5 mt-0.5 mr-1"}),e.jsx(_,{value:a,locales:"en-US",format:{useGrouping:!0},className:"text-sm font-semibold"})]})});return e.jsxs(ge,{children:[e.jsx(pe,{className:"hyperlink flex items-center justify-center shadow-none",children:d}),e.jsx(be,{children:e.jsx(ye,{sideOffset:8,side:"bottom",className:"z-700!",children:e.jsxs(je,{className:"w-96 origin-[var(--transform-origin)] rounded-xs bg-[canvas] px-6 py-4 text-gray-900 shadow-sm shadow-gray-900 transition-[transform,scale,opacity] data-[ending-style]:scale-90 data-[ending-style]:opacity-0 data-[starting-style]:scale-90 data-[starting-style]:opacity-0",children:[e.jsx(ve,{className:"data-[side=bottom]:top-[-8px] data-[side=left]:right-[-13px] data-[side=left]:rotate-90 data-[side=right]:left-[-13px] data-[side=right]:-rotate-90 data-[side=top]:bottom-[-8px] data-[side=top]:rotate-180",children:E("arrow")}),e.jsxs(Ne,{className:"text-gray-500 font-medium text-md flex items-center flex-row p-1 mb-4 gap-1",children:["Issue's Sunshines",e.jsx(L,{variant:"success",static:!0,children:e.jsxs(xe,{children:[e.jsx(_,{value:a,locales:"en-US",format:{useGrouping:!1},className:"font-semibold text-sky-500 dark:text-sky-200"}),I&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xs",children:"→"}),e.jsx(_,{value:i,locales:"en-US",format:{useGrouping:!1},className:"text-xs text-slate-500 dark:text-slate-200"})]})]})})]}),e.jsxs(Ie,{className:"text-gray-600",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6 mt-4",children:[e.jsx("div",{className:"text-6xl mb-2",children:E({iconType:"star",className:"w-16 h-16 text-yellow-400 dark:text-yellow-500",fill:"currentColor"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400 mb-1",children:e.jsx(_,{value:S,locales:"en-US",format:{useGrouping:!1}})}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Potential Stars"}),e.jsxs("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:["(",i," sunshines ÷ 360)"]})]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs(ce,{value:[i],onValueChange:l,max:P,min:0,step:1,className:"relative flex h-5 w-full touch-none select-none items-center",children:[e.jsxs(de,{className:"relative h-[3px] grow rounded-full bg-zinc-300 dark:bg-zinc-800",children:[e.jsx(me,{className:"absolute h-full rounded-full bg-gradient-to-r from-yellow-400 to-orange-500"}),I&&e.jsx("div",{className:"absolute h-full border-l-2 border-dashed border-gray-400 opacity-50",style:{left:`${w/P*100}%`}})]}),e.jsx(he,{className:"relative hyperlink block h-5 w-5 rounded-[1rem] bg-white dark:bg-slate-300 dark:hover:bg-slate-200 shadow-md ring ring-black/10",children:e.jsx(_,{value:i,locales:"en-US",format:{useGrouping:!1},plugins:[Fe],className:"absolute left-1/2 -translate-x-1/2 text-xs text-gray-500 font-semibold"})})]})}),e.jsxs("div",{className:"mb-4 text-center",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Your Sunshines: "}),e.jsx(_,{value:t,locales:"en-US",format:{useGrouping:!1},className:"font-semibold"}),I&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xs",children:"→"}),e.jsx(_,{value:f,locales:"en-US",format:{useGrouping:!1},className:"text-xs"})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(ue,{variant:"primary",onClick:v,disabled:g||!I||u>t,className:fe("px-6",g&&"cursor-wait"),children:g?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"w-5 h-5",variant:"ellipsis"},"ellipsis")," saving..."]}):"Save"})})]})]})})})]})},V=t=>{const{data:a,isPending:x}=Z.useSession(),[p,b]=n.useState(null),[o,i]=n.useState(null),[c,g]=n.useState(!1),[j,w]=n.useState(null),[l,v]=n.useState(0),[,u]=n.useState(!1),f=t.sunshines>0,I=!!t.patchable&&!t.versionTag,P=!!t.versionTag,S=t.tags&&t.tags.length>0?t.tags[0]:void 0;n.useEffect(()=>{t.author&&typeof t.author=="string"&&(g(!0),q(t.author).then(async d=>{if(d&&(b(d),d.userId)){const s=await we(d.userId);s&&i(s)}}).catch(d=>{console.error("Error fetching author:",d)}).finally(()=>{g(!1)}))},[t.author]),n.useEffect(()=>{if(!t.draggable&&!x){const d=a?.user;d?.id?ee(d.id).then(s=>{s&&(w(s),v(s.sunshines||0))}).catch(s=>{console.error("Error fetching current user:",s)}):(w(null),v(0))}},[t.draggable,a,x]);const H=async d=>{if(!j||!t._id||!t.galaxy)return;const s=d-t.sunshines;if(!(s<=0)){u(!0);try{const m=a?.user;if(!m?.email){alert("Please log in to add sunshines");return}if(await Se({issueId:t._id,userId:j._id.toString(),email:m.email,sunshinesToAdd:s})){if(j._id){const k=await q(j._id.toString());k&&v(k.sunshines||0)}}else alert("Failed to update sunshines")}catch(m){console.error("Error updating sunshines:",m),alert("An error occurred while updating sunshines")}finally{u(!1)}}};return e.jsx("div",{className:"flex flex-row gap-1 items-start w-full",children:e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1 ml-0.5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg font-medium text-slate-700 dark:text-slate-300/80",children:t.title}),t.solarForgeTxid&&e.jsx(F,{content:e.jsx("div",{className:"text-sm",children:"View the Solar Forge by this issue on the blockchain explorer"}),children:e.jsx("a",{href:`https://sepolia.basescan.org/tx/${t.solarForgeTxid}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-cyan-400 hover:text-cyan-300 transition-colors",children:e.jsx(W,{className:"w-4 h-4"})})}),e.jsx(L,{variant:f?"success":"gray",static:!0,children:f?"Shining":"Public Backlog"}),P?e.jsx(F,{content:e.jsx("div",{className:"text-sm flex flex-col gap-2 p-2 max-w-xs",children:e.jsxs("div",{children:["Issue is patched. Patch completed ",String(t.patchCompleted),", patch reviewed: '",t.patchTested?"tested":"not tested","'. Its on the roadmap. In the ",e.jsx("span",{className:"font-semibold",children:t.versionTag})," version. Version next status: ",e.jsx("span",{className:"font-semibold",children:t.versionStatus})]})}),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{variant:"info",static:!0,children:t.versionTag}),e.jsx(L,{variant:t.versionStatus==="complete"?"blue":t.versionStatus==="testing"?"warning":t.versionStatus==="release"?"teal":t.versionStatus==="archived"?"green":"gray",static:!0,children:t.versionStatus})]})}):I&&e.jsx(F,{content:e.jsx("div",{className:"text-sm max-w-xs leading-snug",children:"This issue is patchable. Drag and drop into Patching hole."}),children:e.jsx(L,{variant:"orange",static:!0,className:"cursor-pointer select-none shadow-sm",children:e.jsxs("span",{className:"flex items-center gap-1",children:["Patchable ",E("info")]})})}),!P&&!I&&!t.contributor&&e.jsx(F,{content:e.jsx("div",{className:"text-sm max-w-xs leading-snug",children:"This issue has no contributor who takes responsibility yet. Let's wait until maintainer assigns a contributor."}),children:e.jsx(L,{variant:"warning",static:!0,className:"cursor-pointer select-none shadow-sm",children:e.jsxs("span",{className:"flex items-center gap-1",children:["Unassigned ",E("info")]})})})]}),S&&e.jsx(L,{variant:S==="bug"?"danger":S==="feature"?"blue":S==="improvement"?"success":S==="enhancement"?"warning":"info",static:!0,children:S})]}),e.jsx("p",{className:"text-base text-slate-600 dark:text-slate-400",children:t.description}),(t.author||t.createdTime)&&e.jsxs("div",{className:"flex justify-end items-center space-x-1 text-slate-600 dark:text-slate-400 gap-1 text-xs",children:[t.author&&e.jsxs(e.Fragment,{children:["By ",c?e.jsx("div",{className:"w-7 h-7 flex items-center justify-center",children:e.jsx(X,{className:"w-7 h-7",variant:"ellipsis"})}):p?e.jsx(ie,{star:p,src:o?.image,nickname:o?.name||o?.username||o?.email?.split("@")[0]||"Unknown",className:"w-7! h-7!"}):null]}),t.createdTime&&e.jsx(le,{datetime:t.createdTime*1e3})]}),(t.stats||t.actions||t.sunshines>=0)&&e.jsxs(ne,{className:"flex flex-row justify-between items-center mt-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[t.actions&&e.jsx(oe,{className:"",actions:t.actions}),e.jsx(ae,{uri:`/issue?id=${t._id}&galaxy=${t.galaxy}`,asNewTab:!1,children:e.jsxs("button",{className:"inline-flex items-center gap-1 text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors cursor-pointer hyperlink",children:[e.jsx(Be,{className:"w-4 h-4"}),"View Details"]})}),t.solarForgeTxid?e.jsx(F,{content:e.jsx("div",{className:"text-sm",children:"View solar forge transaction on blockchain explorer"}),children:e.jsxs("a",{href:`https://sepolia.basescan.org/tx/${t.solarForgeTxid}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-sm text-cyan-400 hover:text-cyan-300 transition-colors",children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{children:"Solar Forge"})]})}):f&&t.sunshines>0?e.jsx(F,{content:e.jsx("div",{className:"text-sm",children:"Solar forge this issue to convert sunshines to stars"}),children:e.jsxs("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:[e.jsx(W,{className:"w-4 h-4 inline mr-1"}),"Solar Forge"]})}):null]}),t.sunshines>=0&&(!t.draggable&&j?e.jsx(Ge,{availableSunshines:l,currentSunshines:t.sunshines,issueId:t._id||"",galaxyId:t.galaxy,userId:j._id.toString(),onApply:H}):e.jsx(z,{triggerClassName:"text-sm cursor-pointer hover:opacity-80 transition-opacity",iconType:"sunshine",hint:e.jsxs("div",{className:"text-sm space-y-3",children:[e.jsxs("div",{className:"font-semibold",children:["Total sunshines: ",t.sunshines]}),e.jsxs("div",{className:"flex items-center gap-3 pt-2 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"text-4xl",children:E({iconType:"star",className:"w-10 h-10 text-yellow-400 dark:text-yellow-500",fill:"currentColor"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:Math.floor(t.sunshines/360)}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Potential Stars"}),e.jsxs("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:["(",t.sunshines," ÷ 360)"]})]})]})]}),fill:!0,children:t.sunshines})),t.users&&t.users.length>0&&e.jsx(z,{triggerClassName:"text-sm",iconType:"user",hint:"Contributors",fill:!0,children:t.users.length}),t.stats&&Object.values(t.stats).map(d=>e.jsx(z,{triggerClassName:"text-sm",iconType:re(d.type),hint:d.hint,fill:d.filled,children:d.children},d.type))]})]})})},Re=n.memo(t=>{const a=t.patchable?"patch":"issue",[{opacity:x},p]=Ue(()=>({type:a,item:{id:t._id,title:t.title},collect:i=>({opacity:i.isDragging()?.4:1})}),[t._id,t.title,a]),b=t.patchable?"border-amber-300/80 hover:border-amber-400 dark:border-amber-400/70 dark:hover:border-amber-300/90":"border-blue-100/50 hover:border-blue-200 dark:border-blue-500/50 dark:hover:border-blue-500/90",o=t.patchable?"bg-amber-50/50 dark:bg-amber-900/20":"bg-transparent";return e.jsx("div",{ref:p,"data-testid":t._id,style:{opacity:x},className:`cursor-move! border-1 ${b} ${o} transition-colors p-2 border-dashed rounded-md`,children:e.jsx(V,{...t,draggable:!0})})}),C=({tabType:t,draggable:a=!1,filterable:x=!1,description:p,galaxyId:b})=>{const[o,i]=n.useState([]),[c,g]=n.useState(!1),[j,w]=n.useState(!0),l=n.useRef(!1),v=n.useRef(!1),[u,f]=n.useState(new Map),I=n.useCallback(async()=>{if(l.current)try{w(!0);const m=(await Te(b,t)).filter(T=>!(T.listHistory||[]).includes(Q));i(m)}catch(s){console.error("Error fetching issues:",s)}finally{w(!1)}},[t,b]);n.useLayoutEffect(()=>{v.current=!1;const s=y=>{v.current=!0;const h=y,N=h.detail.tabType===t&&h.detail.galaxyId===b;l.current=N,g(N)},m=()=>{l.current&&I()},T=y=>{const N=y.detail;if(!N||!l.current)return;const O=N.listHistory||[];if(O.includes(Q)){if(t===r.SHINING||t===r.PUBLIC){m();return}i(A=>A.filter(G=>G._id!==N._id));return}const $=O.includes(t);if(t===r.SHINING||t===r.PUBLIC){m();return}i($?A=>{const G=A.findIndex(M=>M._id===N._id);if(G>=0){const M=[...A];return M[G]=N,M}else return m(),A}:A=>A.filter(G=>G._id!==N._id))};window.addEventListener(U.ISSUES_TAB_CHANGED,s),window.addEventListener(U.ISSUE_CREATED,m),window.addEventListener(U.ISSUE_UNPATCHED,m),window.addEventListener(U.ISSUE_UPDATE,T),t===r.SHINING&&requestAnimationFrame(()=>{v.current||(l.current=!0,g(!0))});const k=setTimeout(()=>{!v.current&&t===r.SHINING&&(l.current=!0,g(!0))},100);return()=>{clearTimeout(k),window.removeEventListener(U.ISSUES_TAB_CHANGED,s),window.removeEventListener(U.ISSUE_CREATED,m),window.removeEventListener(U.ISSUE_UNPATCHED,m),window.removeEventListener(U.ISSUE_UPDATE,T)}},[t,b,I]),n.useEffect(()=>{c?I():(i([]),w(!1))},[c,I]);const P=[{id:"all",label:"All",sortIds:[{id:"priority",label:"Priority"},{id:"date",label:"Date"},{id:"title",label:"Title"}]},{id:R.BUG,label:"Bug",sortIds:[{id:"priority",label:"Priority"},{id:"date",label:"Date"},{id:"title",label:"Title"}]},{id:R.FEATURE,label:"Feature",sortIds:[{id:"priority",label:"Priority"},{id:"date",label:"Date"},{id:"title",label:"Title"}]},{id:R.IMPROVEMENT,label:"Improvement",sortIds:[{id:"priority",label:"Priority"},{id:"date",label:"Date"},{id:"title",label:"Title"}]},{id:R.ENHANCEMENT,label:"Enhancement",sortIds:[{id:"priority",label:"Priority"},{id:"date",label:"Date"},{id:"title",label:"Title"}]},{id:R.WISH,label:"Wish",sortIds:[{id:"priority",label:"Priority"},{id:"date",label:"Date"},{id:"title",label:"Title"}]},{id:R.CUSTOM,label:"Custom",sortIds:[{id:"priority",label:"Priority"},{id:"date",label:"Date"},{id:"title",label:"Title"}]}],S=(s,m)=>{console.log("Filter changed:",{filterId:s,sortId:m})};n.useEffect(()=>{const s=async()=>{const m=new Set;if(o.forEach(T=>{const y=(T.listHistory||[]).find(h=>h.startsWith("version-"));if(y){const h=y.replace("version-","");h&&!u.has(h)&&m.add(h)}}),m.size>0){const T=Array.from(m).map(async y=>{try{const h=await Ae(y);if(h)return{versionId:y,version:h}}catch(h){console.error(`Error fetching version ${y}:`,h)}return null}),k=await Promise.all(T);f(y=>{const h=new Map(y);return k.forEach(N=>{N&&h.set(N.versionId,N.version)}),h})}};o.length>0&&s()},[o]);const H=n.useMemo(()=>o.map(s=>{const T=(s.listHistory||[]).find(k=>k.startsWith("version-"));if(T){const k=T.replace("version-",""),y=u.get(k);if(y){const h=y.patches.find($=>$.id===s._id),N=h?.completed||!1,O=h?.tested||!1;return{...s,draggable:!1,patchable:!1,versionTag:y.tag,versionStatus:y.status,patchCompleted:N,patchTested:O}}}return{...s,draggable:a,patchable:Ce(s)}}),[a,o,u]),d=s=>s.versionTag?e.jsx("div",{className:"mb-8",children:e.jsx(V,{...s})}):t===r.CLOSED?e.jsx("div",{className:"mb-8",children:e.jsx(V,{...s})}):a&&(s.patchable||s.draggable)?e.jsx("div",{className:"mb-8",children:e.jsx(Re,{...s,patchable:s.patchable,draggable:!0})}):e.jsx("div",{className:"mb-8",children:e.jsx(V,{...s})});return j?e.jsx(J,{className:"max-w-6xl mx-auto max-h-[150vh] overflow-y-auto",children:e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Loading issues..."})})}):e.jsxs(J,{className:"max-w-6xl mx-auto max-h-[150vh] min-h-[50vh] overflow-y-auto",children:[e.jsx("div",{className:"mb-4",children:e.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-200 text-center drop-shadow-lg",children:Pe[t]})}),e.jsxs("div",{className:"mb-4 space-y-2",children:[a&&e.jsxs("p",{className:"text-md text-gray-600 dark:text-gray-500 flex items-center gap-2",children:[E("info")," Issues are draggable. Your dragging will highlight the drop targets."]}),!a&&t===r.CLOSED&&e.jsxs("p",{className:"text-md mb-2 text-gray-600 dark:text-gray-500 flex items-center gap-2",children:[E("lock")," Issues are closed and will never be back."]}),!a&&t!==r.CLOSED&&e.jsxs("p",{className:"text-md mb-2 text-gray-600 dark:text-gray-500 flex items-center gap-2",children:[E("user")," Maintainer can move them."]}),p&&e.jsx("p",{className:"text-md text-gray-600 dark:text-gray-500",children:p})]}),e.jsx(se,{className:"mt-2",items:H,itemComponent:d,title:void 0,titleCenter:!1,searchPlaceholder:"Search issues...",searchableFields:["title","description"],filters:x?P:void 0,onFilterChange:S})]})},Bt=({galaxyId:t})=>{const{data:a,isPending:x}=Z.useSession(),[,p]=n.useState(null),[b,o]=n.useState(!1),[i,c]=n.useState(r.SHINING);n.useEffect(()=>{(async()=>{if(x)return;const v=a?.user;if(v?.id){const u=await ee(v.id);if(u&&u._id){p(u);try{const f=await _e.getIssuesByGalaxy({galaxyId:t});if(f.data?.success&&f.data.issues&&f.data.issues.length>0){const I=u._id.toString(),P=f.data.issues.some(S=>S.maintainer===I);o(P)}else o(!1)}catch(f){console.error("Error checking maintainer status:",f),o(!1)}}else p(null),o(!1)}else p(null),o(!1)})()},[a,x,t]),n.useEffect(()=>{const l=setTimeout(()=>{g(i)},100);return()=>{clearTimeout(l)}},[i]);const g=l=>{window.dispatchEvent(new CustomEvent(U.ISSUES_TAB_CHANGED,{detail:{tabType:l,galaxyId:t}}))},j=async(l,v)=>{try{const u=a?.user;if(!u?.email){console.error("No authenticated user found");return}if(!await ke({issueId:l,email:u.email,listHistory:[v]})){console.error("Failed to update issue");return}}catch(u){console.error("Error changing issue list:",u)}},w=b?[{label:e.jsx(e.Fragment,{children:e.jsx("span",{className:"text-amber-600 dark:text-amber-400 font-semibold",children:"Shining issues"})}),key:r.SHINING,content:e.jsx(D,{backend:B,children:e.jsx(C,{tabType:r.SHINING,draggable:!0,galaxyId:t})}),className:"bg-gradient-to-r from-amber-50 to-yellow-50 dark:from-amber-900/20 dark:to-yellow-900/20"},{label:e.jsx(e.Fragment,{children:"Public Backlog"}),key:r.PUBLIC,content:e.jsx(D,{backend:B,children:e.jsx(C,{tabType:r.PUBLIC,draggable:!0,galaxyId:t})})},{label:e.jsx(D,{backend:B,children:e.jsx(Y,{id:r.INTERESTING,accept:["issue","patch"],onDrop:l=>j(l.id,r.INTERESTING),children:"Interesting Issues"})}),key:r.INTERESTING,content:e.jsx(D,{backend:B,children:e.jsx(C,{tabType:r.INTERESTING,draggable:!0,description:"Interesting issues for the maintainer. It could mean anything, but basically its worth maintainer's attention",galaxyId:t})}),className:" p-0!"},{label:e.jsx(D,{backend:B,children:e.jsx(Y,{id:r.BORING,accept:["issue","patch"],onDrop:l=>j(l.id,r.BORING),children:"Boring Issues"})}),key:r.BORING,content:e.jsx(D,{backend:B,children:e.jsx(C,{tabType:r.BORING,draggable:!0,description:"Issues that are boring for the maintainer. It could be for any reason, but basically maintainer will not spend time on them.",galaxyId:t})})},{label:e.jsx(D,{backend:B,children:e.jsx(Y,{id:r.CLOSED,accept:["issue","patch"],onDrop:l=>j(l.id,r.CLOSED),children:e.jsxs("span",{className:"flex items-center gap-1.5",children:[E({iconType:"lock",className:"w-4 h-4"}),"Closed"]})})}),key:r.CLOSED,content:e.jsx(C,{tabType:r.CLOSED,draggable:!1,galaxyId:t})}]:[{label:e.jsx(e.Fragment,{children:e.jsx("span",{className:"text-amber-600 dark:text-amber-400 font-semibold",children:"Shining issues"})}),key:r.SHINING,content:e.jsx(C,{tabType:r.SHINING,draggable:!1,galaxyId:t}),className:"bg-gradient-to-r from-amber-50 to-yellow-50 dark:from-amber-900/20 dark:to-yellow-900/20"},{label:e.jsx(e.Fragment,{children:"Public Backlog"}),key:r.PUBLIC,content:e.jsx(C,{tabType:r.PUBLIC,draggable:!1,galaxyId:t})},{label:e.jsx(e.Fragment,{children:"Interesting Issues"}),key:r.INTERESTING,content:e.jsx(C,{tabType:r.INTERESTING,draggable:!1,description:"Interesting issues for the maintainer. It could mean anything, but basically its worth maintainer's attention",galaxyId:t})},{label:e.jsx(e.Fragment,{children:"Boring Issues"}),key:r.BORING,content:e.jsx(C,{tabType:r.BORING,draggable:!1,description:"Issues that are boring for the maintainer. It could be for any reason, but basically maintainer will not spend time on them.",galaxyId:t})},{label:e.jsx(e.Fragment,{children:"Closed Issues"}),key:r.CLOSED,content:e.jsx(C,{tabType:r.CLOSED,galaxyId:t})}];return e.jsx(te,{onTabChange:(l=>{c(l)}),activeTab:i,tabs:w})};export{Bt as default};
