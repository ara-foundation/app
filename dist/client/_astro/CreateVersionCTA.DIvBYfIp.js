import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as s}from"./index.DxhH1ShK.js";import{B as p}from"./Button.BK-c6KtM.js";import{S as C,a as x}from"./ScrollStack.BC0PwliQ.js";import{a as N}from"./auth.C6MmFFld.js";import{c as E}from"./roadmap.Cq_m8jGZ.js";import{C as S,a as T}from"./checkbox.DS2acRYq.js";import{L}from"./login-require-for-panel.DJDXBtn0.js";import{c as R}from"./utils.BnlJtBIq.js";import{R as A}from"./roadmap.DwIP75iC.js";import"./ripple.8VKTSqqU.js";import"./slot.RkfkL2mj.js";import"./proxy.D4YeN7SK.js";import"./ElectricBorder.DAWLx7iV.js";import"./virtual.VUcB3V37.js";import"./client.B9YBqyHK.js";import"./patch.CbMO86LR.js";import"./useControlledState.CmDsCfE3.js";import"./index.DpQ8kv17.js";import"./index.C2SuE_cr.js";import"./index.CqUFkXl9.js";import"./index.DXWCtkbr.js";import"./index.DPjcTRdc.js";const I=({galaxyId:m,onSuccess:u,onCancel:o})=>{const{data:l,isPending:g}=N.useSession(),[c,w]=s.useState(""),[b,k]=s.useState(!1),[v,j]=s.useState(0),i=s.useRef(null),n=s.useRef([]),f=s.useRef(null);s.useEffect(()=>{f.current&&setTimeout(()=>f.current?.focus(),100)},[]);const h=s.useCallback(()=>{if(n.current.length===0||!i.current)return;const r=Math.min(v+1,n.current.length-1),t=n.current[r];if(t&&i.current){const a=i.current.querySelector(".scroll-stack-inner");if(a){const d=t.offsetTop-a.offsetTop;a.scrollTo({top:d-100,behavior:"smooth"}),j(r)}}},[v]);s.useEffect(()=>{const r=t=>{(t.key==="Enter"||t.key==="Tab")&&(t.key==="Tab"&&!(t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement)&&t.preventDefault(),t.key==="Enter"&&t.target instanceof HTMLInputElement&&(t.preventDefault(),h()))};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[h]),s.useEffect(()=>{const r=i.current?.querySelector(".scroll-stack-inner");if(!r)return;const t=()=>{};let a;const d=()=>{a=requestAnimationFrame(d)};return r.addEventListener("scroll",()=>{a||(a=requestAnimationFrame(d))}),()=>{a&&cancelAnimationFrame(a),r.removeEventListener("scroll",t)}},[]);const y=async()=>{if(!c.trim()){alert("Please enter a version tag");return}if(!l?.user?.id){alert("Please log in to create a version");return}k(!0);try{await E({galaxyId:m,tag:c.trim()})?u?.():alert("Failed to create version")}catch(t){console.error("Error creating version:",t),alert("An error occurred while creating the version")}finally{k(!1)}};return e.jsxs("div",{className:"fixed inset-0 z-50 pointer-events-none",children:[o&&e.jsx("button",{onClick:o,className:"fixed top-16 right-16 z-50 pointer-events-auto w-10 h-10 rounded-sm bg-white/90 dark:bg-slate-950/95 backdrop-blur-md border border-slate-200/50 dark:border-slate-800/50 shadow-lg flex items-center justify-center text-slate-500 hover:text-slate-700 dark:hover:text-slate-200 transition-all hover:scale-110",children:"âœ•"}),e.jsx("div",{ref:i,className:"absolute bottom-0 left-0 right-0 h-[80vh] pointer-events-auto",children:e.jsxs(C,{useWindowScroll:!1,className:"h-full",children:[e.jsx(x,{itemClassName:"bg-white/5 dark:bg-slate-900/10 backdrop-blur-md border border-white/10 dark:border-slate-700/20 transition-all duration-300",children:e.jsxs("div",{ref:r=>{n.current[0]=r},className:"space-y-4",children:[e.jsx("label",{className:"block text-lg font-semibold text-slate-700 dark:text-slate-300",children:"Version Tag *"}),e.jsx("input",{ref:f,type:"text",value:c,onChange:r=>w(r.target.value),onKeyDown:r=>{r.key==="Enter"&&(r.preventDefault(),h())},placeholder:"Enter a version tag (e.g., v2.0.0)",className:"w-full text-lg px-3 py-2 border border-gray-300/50 dark:border-slate-700/50 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white/30 dark:bg-slate-900/40 backdrop-blur-md"})]})}),e.jsx(x,{itemClassName:"bg-white/5 dark:bg-slate-900/10 backdrop-blur-md border border-white/10 dark:border-slate-700/20 transition-all duration-300",children:e.jsxs("div",{ref:r=>{n.current[1]=r},className:"space-y-4",children:[e.jsx("label",{className:"block text-lg font-semibold text-slate-700 dark:text-slate-300",children:"Maintainer *"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Assign yourself as the maintainer of this version"}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-slate-200/80 dark:bg-slate-800/80 rounded-lg border border-gray-300/50 dark:border-slate-700/50 backdrop-blur-sm",children:[e.jsx(S,{checked:!0,disabled:!0,className:"w-5 h-5 rounded-sm border-2 border-slate-400 dark:border-slate-600 bg-slate-700 dark:bg-slate-800 data-[state=checked]:bg-blue-600 dark:data-[state=checked]:bg-blue-500 data-[state=checked]:border-blue-600 dark:data-[state=checked]:border-blue-500 flex items-center justify-center",children:e.jsx(T,{className:"w-3 h-3 text-white"})}),e.jsx("span",{className:"text-slate-700 dark:text-slate-300 flex-1",children:"Assign to me"})]})]})}),e.jsx(x,{itemClassName:"bg-white/5 dark:bg-slate-900/10 backdrop-blur-md border border-white/10 dark:border-slate-700/20 transition-all duration-300",children:e.jsxs("div",{ref:r=>{n.current[2]=r},className:"flex flex-col items-center gap-4",children:[e.jsx(p,{variant:"primary",size:"lg",onClick:y,disabled:b||!c.trim(),className:"w-full max-w-md backdrop-blur-sm",children:b?"Creating Version...":"Create Version"}),o&&e.jsx(p,{variant:"secondary",size:"md",onClick:o,disabled:b,className:"backdrop-blur-sm",children:"Cancel"})]})})]})})]})},te=({galaxyId:m,onVersionCreated:u})=>{const[o,l]=s.useState(!1),g=()=>{l(!1),setTimeout(()=>{u?.(),window.dispatchEvent(new CustomEvent(A.VERSION_CREATED))},500)};return e.jsxs(e.Fragment,{children:[e.jsx(L,{children:e.jsx("div",{className:R("fixed bottom-4 right-1/2 translate-x-1/2 z-40","backdrop-blur-md bg-white/90 dark:bg-slate-900/90","border border-slate-200/50 dark:border-slate-700/50","rounded-lg shadow-lg","transition-all duration-300","hover:shadow-xl hover:scale-105"),children:e.jsxs(p,{variant:"primary",outline:!0,size:"lg",onClick:()=>l(!0),className:"px-6 py-3 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{children:"Create Version"})]})})}),o&&e.jsx(I,{galaxyId:m,onSuccess:g,onCancel:()=>l(!1)})]})};export{te as default};
