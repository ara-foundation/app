---
import { ClientRouter } from "astro:transitions";
import "@/styles/global.css";
import "@/styles/motion.css";
import Header from "@/components/utilitified_decorations/HeaderCosmic.astro";
import Footer from "@/components/utilitified_decorations/Footer.astro";
import ThreeColumnGrid from "@/components/grid/ThreeColumnGrid.astro";
import GridBackgrounded from "./GridBackgrounded";
import { MenuItemProps } from "@/components/menu/MenuItem";
import { GravityStarsBackground } from "@/components/animate-ui/components/backgrounds/gravity-stars";
import { GradientBackground } from "@/components/animate-ui/components/backgrounds/gradient";
import Galaxy from "@/components/Galaxy";
import GalaxyLayoutBody from "@/components/galactic/GalaxyLayoutBody";
import Space from "@/components/galactic/Space";
import { UserStarData } from "@/components/galactic/Space";

interface Props {
  active?: string;
  hideLinks?: string[];
  hideAuth?: boolean;
  additional?: MenuItemProps[];
  projectName?: string;
  initialZoom?: number;
  minZoom?: number;
  maxZoom?: number;
  maxGalaxyContent?: number;
  stars?: UserStarData[];
  projectGoal?: number;
}
const {
  hideLinks,
  hideAuth,
  additional,
  projectName,
  initialZoom,
  minZoom,
  maxZoom,
  maxGalaxyContent,
  stars,
  projectGoal,
} = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="/cascadefund_logo.png" />
    <meta name="generator" content={Astro.generator} />
    <title>{"'" + projectName + "' star galaxy"}</title>
    <ClientRouter />
  </head>
  <body
    class="min-h-screen bg-slate-200 dark:bg-slate-800 border-1 border-red-500/10"
  >
    <!-- Background Container - Will be transformed by GalaxyZoomWrapper -->
    <div
      data-galaxy-backgrounds
      style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; transform-origin: center center; pointer-events: auto; z-index: 0; overflow: hidden;"
    >
      <GradientBackground
        className="fixed h-screen w-screen z-0 pointer-events-none"
        client:load
      />
      <GridBackgrounded />
      <GravityStarsBackground
        className="fixed h-screen w-screen z-1 pointer-events-none"
        client:load
      />
      <div class="fixed h-screen w-screen z-2">
        <Galaxy
          client:only="react"
          mouseInteraction={false}
          speed={0.25}
          rotationSpeed={0.015}
          twinkleIntensity={0.1}
          glowIntensity={0.1}
          autoCenterRepulsion={0.5}
        />
      </div>
      <slot
        name="background"
        class="fixed h-screen w-screen z-3 pointer-events-none"
      />
    </div>

    <!-- Content Container - Will be transformed by GalaxyZoomWrapper -->
    <div data-galaxy-fixed>
      <Header hideLinks={hideLinks} hideAuth={hideAuth} additional={additional}>
        <slot name="header-navbar" />
      </Header>
    </div>
    <div
      data-galaxy-content
      class="z-2 relative border border-red-500/10"
      style="transform-origin: center center;"
    >
      <Space client:only="react" users={stars || []} className="z-10" />
      <section class="mt-6">
        <slot name="hero" />
      </section>
      <ThreeColumnGrid
        centerPercents="3/5"
        className="mx-auto py-16 space-x-8 px-8 min-h-[calc(100vh-4rem)]"
      >
        <slot name="left" class="mr-4" slot="left" />
        <slot name="center" class="mx-4" slot="center" />
        <slot name="right" class="ml-4" slot="right" />
      </ThreeColumnGrid>
    </div>
    <div data-galaxy-fixed>
      <Footer />
    </div>

    <GalaxyLayoutBody
      client:only="react"
      projectName={projectName}
      initialZoom={initialZoom}
      minZoom={minZoom}
      maxZoom={maxZoom}
      maxGalaxyContent={maxGalaxyContent}
    />
  </body>
</html>
